-- Test file for VSCode syntax highlighting

-- 1. New functions and keywords
from behavior_weblogs.subscribe(watermark_column = 'time', window_size = '1h')

from unnest([1, 2, 3]) as t(number)
lateral view explode(items) tbl as item

-- 2. Insert Into syntax  
insert into users (id, name) values (1, 'Alice')

from new_data
insert into existing_table

-- 3. Create (Update/Alter are not supported in Wvlet)
create table new_table as select * from old_table

-- 4. Backtick with interpolation
select `column_${env}_name` from table

-- 5. Underscore as special variable
from users
where _.age > 21
test _.count should be 100

-- 6. Test syntax variations
test result should contain 'success'
test output should be """
| id | name  |
|----|-------|
| 1  | Alice |
"""

-- 7. Incremental keywords
incremental append
watermark by timestamp_column

-- 8. Complex example
model UserStats(userId: int, name: string, signupDate: date)

def getActiveUsers = 
  from UserStats 
  where signupDate > date("2023-01-01")
  select userId, name
  order by signupDate desc
  limit 100

val message = "User ${user.name} has score ${user.score}"

-- Triple quoted strings
execute sql"""
  SELECT * FROM table
  WHERE column = ${value}
"""